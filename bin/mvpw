#!/usr/bin/env python

from pw.core import Cli


def lookup_credential(cli, search_term):
    cli.pw_store.load()
    name = cli.pw_store.lookup_credential_for_edit(search_term)
    new_name = None
    if name in cli.pw_store.data:
        result = 'renamed to '
        new_name = raw_input('new name: ')
        credential = cli.pw_store.data.pop(name, None)
        cli.pw_store.data[new_name] = credential
        cli.pw_store.save()

    else:
        result = 'not found'

    print '{} {}{}'.format(name, result, new_name)

#
# Main program
#
parser = Cli.create_arg_parser('Rename credentials.')
args = parser.parse_args()
cli = Cli(args.pw_file)
cli.run('rename', lookup_credential, args.credential_name)
